#include "core_includes.h"

////////////////////////////////////////////////////////////////////////////////////////////////////
// _write
////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_CORE_FUN(write) {
  int written = 0;

  FOR_EACH(elem, args) {
    written += WRITE(elem);

    if (! NILP(CDR(position))) {
      SPC;
      written++;
    }
  }

  fflush(stdout);

  RETURN(NEW_INT(written));
  
  END_DEF_CORE_FUN;
}
////////////////////////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////
// _put
////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_CORE_FUN(put) {
  int written = 0;

  FOR_EACH(elem, args) {
    written += PUT(elem);

    if (! NILP(CDR(position))) {
      SPC;
      written++;
    }
  }

  fflush(stdout);

  RETURN(NEW_INT(written));
  
  END_DEF_CORE_FUN;
}
////////////////////////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////
// _princ
////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_CORE_FUN(princ) {
  int written = 0;

  FOR_EACH(elem, args)
    written += PRINC(elem);

  fflush(stdout);

  RETURN(NEW_INT(written));
  
  END_DEF_CORE_FUN;
}
////////////////////////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////
// _print
////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_CORE_FUN(print) {
  int written = 0;

  FOR_EACH(elem, args) {
    written += PRINT(elem);

    if (! NILP(CDR(position))) {
      SPC;
      written++;
    }
  }

  fflush(stdout);

  RETURN(NEW_INT(written));

  END_DEF_CORE_FUN;
}
////////////////////////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////
// _nl
////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_CORE_FUN(nl) {
  NL;

  RETURN(NEW_INT(1));

  END_DEF_CORE_FUN;
}
////////////////////////////////////////////////////////////////////////////////////////////////////
