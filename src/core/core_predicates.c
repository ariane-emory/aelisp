#include "core_includes.h"

#include "env.h"

////////////////////////////////////////////////////////////////////////////////////////////////////
// _eq
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(eq) {
  FOR_EACH(tailarg, CDR(args))
    if (CAR(args) != tailarg)
      RETURN(NIL);

  RETURN(TRUE);
  
  END_DEF_CORE_FUN(eq);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _eql
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(eql) {
  FOR_EACH(tailarg, CDR(args))
    if (! EQL(CAR(args), tailarg))
      RETURN(NIL);

  RETURN(TRUE);
  
  END_DEF_CORE_FUN(eql);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _tailp
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(tailp) {
  RETURN(TRUTH(TAILP(CAR(args))));
  
  END_DEF_CORE_FUN(tailp);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _properp
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(properp) {
  REQUIRE(env, args, CONSP(CAR(args)));
  RETURN(TRUTH(PROPERP(CAR(args))));
  
  END_DEF_CORE_FUN(properp);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _boundp
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(boundp) {
  REQUIRE(env, args, SYMBOLP(CAR(args)));
  RETURN(TRUTH(ENV_BOUNDP(env, CAR(args))));
  
  END_DEF_CORE_FUN(boundp);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _keywordp
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(keywordp) {
  REQUIRE(env, args, SYMBOLP(CAR(args)));
  RETURN(TRUTH(KEYWORDP(CAR(args))));
  
  END_DEF_CORE_FUN(keywordp);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _id
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(id) {
  RETURN(CAR(args));
  
  END_DEF_CORE_FUN(id);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _not
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(not) {
  RETURN(TRUTH(NILP(CAR(args))));
  
  END_DEF_CORE_FUN(not);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _nilp
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(nilp) {
  RETURN(TRUTH(NILP(CAR(args))));

  END_DEF_CORE_FUN(nil?);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _zerop
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(zerop) {
  REQUIRE(env, args, INTEGERP(CAR(args)), "argument must be an integer");
  RETURN(TRUTH(INT_VAL(CAR(args)) == 0));
  
  END_DEF_CORE_FUN(zero?);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _onep
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(onep) {
  REQUIRE(env, args, INTEGERP(CAR(args)), "argument must be an integer");
  RETURN(TRUTH(INT_VAL(CAR(args)) == 1));
  
  END_DEF_CORE_FUN(one?);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _positivep
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(positivep) {
  REQUIRE(env, args, INTEGERP(CAR(args)), "argument must be an integer");
  RETURN(TRUTH(INT_VAL(CAR(args)) >= 0));

  END_DEF_CORE_FUN(positive?);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _negativep
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(negativep) {
  REQUIRE(env, args, INTEGERP(CAR(args)), "argument must be an integer");
  RETURN(TRUTH(INT_VAL(CAR(args)) < 0));
  
  END_DEF_CORE_FUN(negative?);
}

