#include "core_includes.h"
#include "env.h"

////////////////////////////////////////////////////////////////////////////////////////////////////
// _env
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(env) {
  if (args_length == 1) {
    REQUIRE(env, args, (ENVP(CAR(args)) || LAMBDAP(CAR(args)) || MACROP(CAR(args))));

    if (ENVP(CAR(args))) {
      RETURN(ENV_PARENT(CAR(args)));
    }
    else {
      RETURN(FUN_ENV(CAR(args)));
    }
  }

  RETURN(env);

  END_DEF_CORE_FUN(env);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _syms
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(syms) {
  if (args_length == 1) {
    REQUIRE(env, args, ENVP(CAR(args)));

    RETURN(ENV_SYMS(CAR(args)));
  }

  RETURN(ENV_SYMS(env));
  
  END_DEF_CORE_FUN(syms);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _vals
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(vals) {
  if (args_length == 1) {
    REQUIRE(env, args, ENVP(CAR(args)));

    RETURN(ENV_VALS(CAR(args)));
  }

  RETURN(ENV_VALS(env));
  
  END_DEF_CORE_FUN(vals);
}

