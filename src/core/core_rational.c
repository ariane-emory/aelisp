#include "core_includes.h"

////////////////////////////////////////////////////////////////////////////////////////////////////
// _rational
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(rational) {
  REQUIRE(INTEGERP(CAR(args)));
  REQUIRE(INTEGERP(CADR(args)));

  RETURN(NEW_RATIONAL(INT_VAL(CAR(args)), INT_VAL(CADR(args))));

  END_DEF_CORE_FUN(rational);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _numer
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(numer) {
  REQUIRE(RATIONALP(CAR(args)) || INTEGERP(CAR(args)));

  RETURN(INTEGERP(CAR(args))
         ? CAR(args)
         : NEW_INT(NUMER_VAL(CAR(args))));
  
  END_DEF_CORE_FUN(numer);
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// _denom
////////////////////////////////////////////////////////////////////////////////////////////////////

DEF_CORE_FUN(denom) {
  REQUIRE(RATIONALP(CAR(args)) || INTEGERP(CAR(args)));

  RETURN(NEW_INT((RATIONALP(CAR(args)))
                 ? DENOM_VAL(CAR(args))
                 : 1));
  END_DEF_CORE_FUN(denom);
}

