#include <string.h>

#include "core_includes.h"

#include "write.h"

////////////////////////////////////////////////////////////////////////////////////////////////////
// _string
////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_CORE_FUN(string) {
  char * const tmp        = SPRINC(CAR(args));
  char * const new_string = free_list_malloc(strlen(tmp) + 1);

  strcpy(new_string, tmp);
  free(tmp);
  
  RETURN(NEW_STRING(new_string));

  END_DEF_CORE_FUN(string);
}
////////////////////////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////
// _intern
////////////////////////////////////////////////////////////////////////////////////////////////////
DEF_CORE_FUN(intern) {
  if (! STRINGP(CAR(args)))
    LOG(CAR(args), "not a string");
  
  REQUIRE(STRINGP(CAR(args)), "intern's first argument must be a string");

  RETURN(SYM(STR_VAL(CAR(args))));

  END_DEF_CORE_FUN(intern);
}
////////////////////////////////////////////////////////////////////////////////////////////////////
