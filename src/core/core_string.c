#include <string.h>

#include "core_includes.h"

#include "write.h"

////////////////////////////////////////////////////////////////////////////////////////////////////
// _string
////////////////////////////////////////////////////////////////////////////////////////////////////
ae_obj_t * ae_core_string(ae_obj_t * const env,
                          ae_obj_t * const args,
                          __attribute__((unused)) int args_length) {
  CORE_BEGIN("string");

  char * const tmp        = SPRINC(CAR(args));
  char * const new_string = free_list_malloc(strlen(tmp) + 1);
  strcpy(new_string, tmp);
  free(tmp);
  
  RETURN(NEW_STRING(new_string));

  CORE_END("string");
}
////////////////////////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////////////////////////
// _intern
////////////////////////////////////////////////////////////////////////////////////////////////////
ae_obj_t * ae_core_intern(ae_obj_t * const env,
                          ae_obj_t * const args,
                          __attribute__((unused)) int args_length) {
  CORE_BEGIN("intern");

  if (! STRINGP(CAR(args)))
    LOG(CAR(args), "not a string");
  
  REQUIRE(env, args, STRINGP(CAR(args)), "intern's 1st arg must be a string");

  RETURN(SYM(STR_VAL(CAR(args))));

  CORE_END("intern");
}
////////////////////////////////////////////////////////////////////////////////////////////////////
